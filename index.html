<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Text to HTML Converter</title>
    <script src="https://cdn.tiny.cloud/1/gmtefa4tnozu32ym5kwdt7cp9nnxfpc76pnmdbz3e5tmjhfg/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.css">
</head>
<body>
    <h1>Text to HTML Converters</h1>
    
    <h2 id="visual-editor-heading">Visual Editor</h2>
    <textarea id="wordContent" placeholder="Enter your text here"></textarea>

    <h2 id="html-editor-heading">HTML Editor</h2>
    <textarea id="htmlContent" placeholder="Converted HTML will be displayed here"></textarea>

    <button onclick="convertToHtml()">Convert to HTML</button>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.62.0/mode/xml/xml.min.js"></script>
    <script>
        tinymce.init({
            selector: '#wordContent',
            height: 400,
            plugins: 'wordcount',
            toolbar: 'undo redo | bold italic | alignleft aligncenter alignright alignjustify | outdent indent | wordcount'
        });

        var htmlEditor = CodeMirror.fromTextArea(document.getElementById("htmlContent"), {
            lineNumbers: true,
            mode: "text/html",
            readOnly: true,
            lineWrapping: true
        });

        function convertToHtml() {
            var wordContent = tinymce.get('wordContent').getContent();
            var sanitizedHtml = sanitizeHtml(wordContent);
            htmlEditor.setValue(sanitizedHtml);
        }

        function sanitizeHtml(html) {
            // Remove dir="ltr" attribute and empty span, div tags
            html = html.replace(/<(\/*)(span|div)[^>]*>/gi, '');

            // Replace italicized text with <em> tags
            html = html.replace(/\*(.*?)\*/g, '<em>$1</em>');

            // Replace bold text with <strong> tags
            html = html.replace(/\[(.*?)\]/g, '<strong>$1</strong>');

            // Add <p> tags to paragraphs
            html = html.split('\n').map(line => line.trim() ? `<p>${line}</p>` : '').join('');

            // Remove <p> tags inside tables
            html = html.replace(/<table\b[^>]*>(.*?)<\/table>/gi, function(match) {
                return match.replace(/<p\b[^>]*>(.*?)<\/p>/gi, '$1');
            });

            return html;
        }

        function slugify(text) {
            return text.trim().toLowerCase().replace(/[^\w\s\-]/g, '').replace(/\s+/g, '-');
        }

        function isInternalLink(url) {
            return url.includes('uworld.com') || url.startsWith('/') || url.startsWith('#');
        }
    </script>
</body>
</html>
